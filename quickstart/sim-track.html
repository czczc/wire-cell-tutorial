<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Simulate Tracks | Learning Wire-Cell</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Welcome to Wire-Cell">
    
    <link rel="preload" href="/wire-cell-tutorial/assets/css/0.styles.680c0408.css" as="style"><link rel="preload" href="/wire-cell-tutorial/assets/js/app.66e51239.js" as="script"><link rel="preload" href="/wire-cell-tutorial/assets/js/2.dbcb943a.js" as="script"><link rel="preload" href="/wire-cell-tutorial/assets/js/7.7dac8a4b.js" as="script"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/10.16ff3881.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/11.086d9eac.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/12.0abf799c.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/13.c98cf500.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/14.67f75223.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/15.963ab451.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/16.396153b8.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/17.3640c554.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/18.2a0e9037.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/19.a7870ed4.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/20.9a38ff70.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/21.784ee3f9.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/22.dca24c4f.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/23.cf530d91.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/24.64fc17f8.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/25.ce97cb86.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/3.2fc75dc0.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/4.53f0bcde.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/5.de6fb2c7.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/6.f6b2dd80.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/8.ddf5680c.js"><link rel="prefetch" href="/wire-cell-tutorial/assets/js/9.d33b9c24.js">
    <link rel="stylesheet" href="/wire-cell-tutorial/assets/css/0.styles.680c0408.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wire-cell-tutorial/" class="home-link router-link-active"><img src="/wire-cell-tutorial/img/logo.png" alt="Learning Wire-Cell" class="logo"> <span class="site-name can-hide">Learning Wire-Cell</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wire-cell-tutorial/intro.html" class="nav-link">
  Main
</a></div><div class="nav-item"><a href="/wire-cell-tutorial/quickstart/explore-data.html" class="nav-link">
  Quick starts
</a></div><div class="nav-item"><a href="/wire-cell-tutorial/appendix/software.html" class="nav-link">
  Appendix
</a></div> <a href="https://github.com/czczc/wire-cell-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wire-cell-tutorial/intro.html" class="nav-link">
  Main
</a></div><div class="nav-item"><a href="/wire-cell-tutorial/quickstart/explore-data.html" class="nav-link">
  Quick starts
</a></div><div class="nav-item"><a href="/wire-cell-tutorial/appendix/software.html" class="nav-link">
  Appendix
</a></div> <a href="https://github.com/czczc/wire-cell-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/wire-cell-tutorial/quickstart/explore-data.html" class="sidebar-link">Explore Real Data</a></li><li><a href="/wire-cell-tutorial/quickstart/examine-graph.html" class="sidebar-link">Examine Program Flow</a></li><li><a href="/wire-cell-tutorial/quickstart/write-dfp.html" class="sidebar-link">Write a Module</a></li><li><a href="/wire-cell-tutorial/quickstart/sim-track.html" aria-current="page" class="active sidebar-link">Simulate Tracks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wire-cell-tutorial/quickstart/sim-track.html#line-charge-simulation" class="sidebar-link">Line charge simulation</a></li><li class="sidebar-sub-header"><a href="/wire-cell-tutorial/quickstart/sim-track.html#userdefined-charge-deposition-in-json-format" class="sidebar-link">Userdefined charge deposition (in JSON format)</a></li><li class="sidebar-sub-header"><a href="/wire-cell-tutorial/quickstart/sim-track.html#geant4-simulated-charge-deposition-larsoft-interface" class="sidebar-link">Geant4-simulated charge deposition (LArSoft interface)</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="simulate-tracks"><a href="#simulate-tracks" class="header-anchor">#</a> Simulate Tracks</h1> <p></p><div class="table-of-contents"><ul><li><a href="#line-charge-simulation">Line charge simulation</a></li><li><a href="#userdefined-charge-deposition-in-json-format">Userdefined charge deposition (in JSON format)</a></li><li><a href="#geant4-simulated-charge-deposition-larsoft-interface">Geant4-simulated charge deposition (LArSoft interface)</a><ul><li><a href="#step-1-generator">Step 1: Generator</a></li><li><a href="#step-2-geant4">Step 2: Geant4</a></li><li><a href="#step-3-wire-cell-electron-drift-simulation">Step 3: Wire-Cell electron drift simulation</a></li><li><a href="#step-4-noise-filtering-signal-processing-and-3d-imaging">Step 4: Noise filtering, signal processing and 3D imaging</a></li></ul></li></ul></div><p></p> <h2 id="line-charge-simulation"><a href="#line-charge-simulation" class="header-anchor">#</a> Line charge simulation</h2> <p>To start with an easy example, let's simulate an ideal-line charge in the protoDUNE-SP TPC.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>wire-cell -c pgrapher/experiment/pdsp/wct-sim-check.jsonnet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The configuration is available <a href="https://github.com/WireCell/wire-cell-cfg/blob/master/pgrapher/experiment/pdsp/wct-sim-check.jsonnet" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It is also possible to simulate multiple line charges. For instance, two line charges are simulated in the following example. The charge deposition is set to 2500 electrons per step, and the step length is set to 0.5mm. Therefore, it mimics two MIP tracks with charge deposition of ~5000 e/mm.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>local cathpier <span class="token operator">=</span> <span class="token punctuation">{</span>
  tail<span class="token operator">:</span> wc<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">585</span><span class="token punctuation">,</span> <span class="token number">409</span><span class="token punctuation">,</span> wc<span class="token punctuation">.</span>cm<span class="token punctuation">)</span><span class="token punctuation">,</span>
  head<span class="token operator">:</span> wc<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span> <span class="token number">118</span><span class="token punctuation">,</span>  <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> wc<span class="token punctuation">.</span>cm<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

local parallel <span class="token operator">=</span> <span class="token punctuation">{</span>
  tail<span class="token operator">:</span> wc<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.000</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">1.000</span><span class="token punctuation">,</span> wc<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>
  head<span class="token operator">:</span> wc<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.000</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">2.000</span><span class="token punctuation">,</span> wc<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

local tracklist <span class="token operator">=</span> <span class="token punctuation">[</span>

  <span class="token punctuation">{</span>
    time<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">*</span> wc<span class="token punctuation">.</span>us<span class="token punctuation">,</span>
    charge<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2500</span><span class="token punctuation">,</span> <span class="token comment">// 2500 electrons/depo</span>
    ray<span class="token operator">:</span> cathpier<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    time<span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">*</span> wc<span class="token punctuation">.</span>us<span class="token punctuation">,</span>
    charge<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2500</span><span class="token punctuation">,</span>
    ray<span class="token operator">:</span> parallel<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

local depos <span class="token operator">=</span> sim<span class="token punctuation">.</span><span class="token function">tracks</span><span class="token punctuation">(</span>tracklist<span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">0.5</span> <span class="token operator">*</span> wc<span class="token punctuation">.</span>mm<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>By runing the example configuration (<code>wct-sim-check.jsonnet</code>), a <strong>Magnify</strong> file is obtained. In this example, given the line-charge (electron) depositions in the space and time, the Wire-Cell core simulation is carried out. While more complicated simulations will be introduced below such as userdefined electron depos and realistic charge depos from Geant4 detector simulation.</p> <h2 id="userdefined-charge-deposition-in-json-format"><a href="#userdefined-charge-deposition-in-json-format" class="header-anchor">#</a> Userdefined charge deposition (in JSON format)</h2> <p>To be updated.</p> <h2 id="geant4-simulated-charge-deposition-larsoft-interface"><a href="#geant4-simulated-charge-deposition-larsoft-interface" class="header-anchor">#</a> Geant4-simulated charge deposition (LArSoft interface)</h2> <h3 id="step-1-generator"><a href="#step-1-generator" class="header-anchor">#</a> Step 1: Generator</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>lar -n1 -c gen_protoDune_pion_7p0GeV_mono.fcl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>You can get an output file with name similar to <code>gen_protoDune_pion_7p0GeV_mono.root</code>. Through <code>eventdump</code>, one can see that the generator information is saved in <code>simb::MCTruth</code>.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Begin processing the 1st record. run: <span class="token number">1</span> subRun: <span class="token number">0</span> event: <span class="token number">1</span> at <span class="token number">13</span>-Aug-2019 <span class="token number">13</span>:47:55 EDT
PRINCIPAL TYPE: Event
PROCESS NAME <span class="token operator">|</span> MODULE LABEL<span class="token punctuation">..</span> <span class="token operator">|</span> PRODUCT <span class="token environment constant">INSTANCE</span> NAME <span class="token operator">|</span> DATA PRODUCT TYPE<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> SIZE
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> generator<span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>simb::MCTruth<span class="token operator">&gt;</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span>.1
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> rns<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>art::RNGsnapshot<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token punctuation">..</span>.1
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> TriggerResults <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> art::TriggerResults<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span>.-
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="step-2-geant4"><a href="#step-2-geant4" class="header-anchor">#</a> Step 2: Geant4</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>lar -n1 -c pgrapher/experiment/pdsp/Quickstart/protoDUNE_g4_wirecell.fcl gen_protoDune_pion_7p0GeV_mono.root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The Geant4 simulation above requires a photon library data file in a special CVMFS repository (/cvmfs/dune.osgstorage.org/pnfs/fnal.gov/usr/dune/persistent/stash/PhotonPropagation/LibraryData/lib_Protodunev7.root). You have two options to access.</p> <ol><li>Configure the proxy for <code>dune.osgstorage.gov</code> by following the instruction in <a href="../install">Install CVMFS</a></li> <li>Download the <a href="https://www.phy.bnl.gov/~wgu/wire-cell-tutorial/data/sim/PhotonPropagation.tar.gz" target="_blank" rel="noopener noreferrer">PhotonPropagation.tar.gz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, unpack it and set the environment properly to make the directory <code>PhotonPropagation</code> available to LArSoft. For example,</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">FW_SEARCH_PATH</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable">$FW_SEARCH_PATH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Once the simulation accomplished, you can dump the event information for the output file <code>gen_protoDune_pion_7p0GeV_mono_g4.root</code>. Here, the <code>G4:ionization:vector&lt;sim::SimEnergyDeposit&gt;</code> is the data product we want to pass to the Wire-Cell simulation.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Begin processing the 1st record. run: <span class="token number">1</span> subRun: <span class="token number">0</span> event: <span class="token number">1</span> at <span class="token number">13</span>-Aug-2019 <span class="token number">13</span>:26:38 CDT
PRINCIPAL TYPE: Event
PROCESS NAME <span class="token operator">|</span> MODULE LABEL<span class="token punctuation">..</span> <span class="token operator">|</span> PRODUCT <span class="token environment constant">INSTANCE</span> NAME <span class="token operator">|</span> DATA PRODUCT TYPE<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> .SIZE
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> generator<span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>simb::MCTruth<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1</span>
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> rns<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>art::RNGsnapshot<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1</span>
SinglesGen<span class="token punctuation">..</span> <span class="token operator">|</span> TriggerResults <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> art::TriggerResults<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>-
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::OpDetBacktrackerRecord<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span>.60
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> rns<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>art::RNGsnapshot<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">2</span>
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> Other<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::SimEnergyDeposit<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> .1168
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> TriggerResults <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> art::TriggerResults<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>-
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>simb::MCParticle<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> .2086
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::AuxDetSimChannel<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> .2048
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> TPCActive<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::SimEnergyDeposit<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token number">90236</span>
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> ionization<span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::SimEnergyDeposit<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token number">90236</span>
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> art::Assns<span class="token operator">&lt;</span>simb::MCTruth,simb::MCParticle,sim::GeneratedParticleInfo<span class="token operator">&gt;</span> <span class="token operator">|</span> .2086
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::SimChannel<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> .4010
G4<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> largeant<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>sim::SimPhotonsLite<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token punctuation">..</span>.60
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="step-3-wire-cell-electron-drift-simulation"><a href="#step-3-wire-cell-electron-drift-simulation" class="header-anchor">#</a> Step 3: Wire-Cell electron drift simulation</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>lar -n1 -c pgrapher/experiment/pdsp/Quickstart/wcls-sim-check.fcl gen_protoDune_pion_7p0GeV_mono_g4.root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Please check if you can see the raw digit information in the output file: <code>gen_protoDune_pion_7p0GeV_mono_g4_wcsim.root</code>.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>wclssim<span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> tpcrawdecoder. <span class="token operator">|</span> daq<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token operator">|</span> std::vector<span class="token operator">&lt;</span>raw::RawDigit<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token operator">|</span> <span class="token number">15360</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="step-4-noise-filtering-signal-processing-and-3d-imaging"><a href="#step-4-noise-filtering-signal-processing-and-3d-imaging" class="header-anchor">#</a> Step 4: Noise filtering, signal processing and 3D imaging</h3> <p>With the <code>std::vector&lt;raw::RawDigit&gt;</code> obtained above, the noise filtering/signal processing and 3D imaging can be performanced in order.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>lar -n1 -c pgrapher/experiment/pdsp/wcls-nf-sp.fcl gen_protoDune_pion_7p0GeV_mono_g4_wcsim.root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Here is the 2D display of the deconvolved charge for the above 7-GeV pion interaction.
<img src="/wire-cell-tutorial/assets/img/protoDune_pion_7p0GeV.5e00a4c3.png" alt="protoDune-pion-7p0GeV"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/czczc/wire-cell-tutorial/edit/master/quickstart/sim-track.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/30/2019, 10:49:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/wire-cell-tutorial/quickstart/write-dfp.html" class="prev">
        Write a Module
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/wire-cell-tutorial/assets/js/app.66e51239.js" defer></script><script src="/wire-cell-tutorial/assets/js/2.dbcb943a.js" defer></script><script src="/wire-cell-tutorial/assets/js/7.7dac8a4b.js" defer></script>
  </body>
</html>
